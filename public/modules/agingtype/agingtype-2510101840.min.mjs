/*! agingtype
*
* build at 2025-10-10
*/
import*as e from"/public/libs/webmodule/pagehelper.mjs";const t=new $fgta5.Application("mainapp");var n={moduleName:"agingtype",app:t,urlDir:"public/modules/agingtype",Crsl:new $fgta5.SectionCarousell(t.Nodes.Main),Sections:{agingtypeHeaderList:"agingtypeHeaderList-section",agingtypeHeaderEdit:"agingtypeHeaderEdit-section"},SectionMap:{"agingtypeHeaderList-section":"agingtypeHeaderList","agingtypeHeaderEdit-section":"agingtypeHeaderEdit"}};async function a(e,t){}var o=Object.freeze({__proto__:null,init:a});const i=n.Crsl,c=n.Sections.agingtypeHeaderList,r=i.Items[c],s={},d=new $fgta5.Gridview("agingtypeHeaderList-tbl"),l=document.getElementById("agingtypeHeaderList-pnl_search"),u=new $fgta5.ActionButton("agingtypeHeaderList-btn_gridload"),g=r,f={};async function y(e,t){d.addEventListener("nextdata",async t=>{!async function(e,t){const n=t.detail.criteria,a=t.detail.limit,o=t.detail.nextoffset,i=t.detail.sort;await v(e,{criteria:n,limit:a,offset:o,sort:i}),d.scrollToFooter()}(e,t)}),d.addEventListener("sorting",async t=>{!function(e,t){d.clear();const n=t.detail.sort,a=t.detail.Criteria;v(e,{criteria:a,sort:n})}(e,t)});const n=o.headerList_addTableEvents;"function"==typeof n&&n(e,d),Module.isMobileDevice()?d.addEventListener("cellclick",async t=>{E(e,t)}):d.addEventListener("celldblclick",async t=>{E(e,t)}),u.addEventListener("click",async t=>{!function(e){w(e,null),p(e)}(e)});try{const t=document.querySelector('template[name="custom-search-panel"]');if(null!=t){const e=t.content.cloneNode(!0);l.prepend(e)}const n=l.querySelectorAll("[fgta5-component][binding]");for(var a of n){var i=a.getAttribute("id"),c=a.getAttribute("fgta5-component"),r=a.getAttribute("binding");f[r]=new $fgta5[c](i)}const s=document.getElementById("agingtypeHeaderList-txt_searchtext"),d=document.getElementById("agingtypeHeaderList-btn_gridload");s.addEventListener("keydown",e=>{"enter"==e.key.toLowerCase()&&(e.stopPropagation(),d.click(),s.blur())});const u=o["headerList_initSearchParams"];"function"==typeof u&&u(e,f)}catch(e){throw e}finally{!0===t.autoLoadGridData&&p(e)}}async function p(e){await d.clear(),v(e)}function m(e,t){const n=s.SelectedRow;n.previousElementSibling?t.disablePrevButton(e,!1):t.disablePrevButton(e,!0),n.nextElementSibling?t.disableNextButton(e,!1):t.disableNextButton(e,!0)}function w(e,t){s.SelectedRow=t}async function b(e,t){const n=t.getAttribute("keyvalue"),a=t.getAttribute("key"),o=e.Modules.agingtypeHeaderEdit;o.clearForm(e,"loading...");try{w(0,t),s.SelectedRow.keyValue=n,s.SelectedRow.key=a,await o.openSelectedData(e,{key:a,keyvalue:n})}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message),w(0,null),r.show()}m(e,o)}function E(e,t){const n=t.detail.tr;e.Modules.agingtypeHeaderEdit.Section.show({},t=>{b(e,n)})}async function v(e,t={}){const{criteria:a={},limit:o=0,offset:i=0,sort:c={}}=t;for(var r in f){if(!f[r].validate())return console.error("ada yang belum diisi"),!1;a[r]=f[r].value}void 0===c&&(c=d.getSort());let s=$fgta5.Modal.createMask();try{const e=await async function(e,t,a,o,i){const c=`/${n.moduleName}/header-list`;try{const e=[];return await Module.apiCall(c,{columns:e,criteria:t,offset:a,limit:o,sort:i})}catch(e){throw e}}(0,a,i,o,c);0===i&&d.clear(),d.addRows(e.data),d.setNext(e.nextoffset,e.limit)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{s.close(),s=null}}var h=Object.freeze({__proto__:null,SearchParams:f,Section:g,addNewRow:function(e,t){w(e,d.addRow(t))},getCurrentRow:function(e){return s.SelectedRow},getGrid:function(e){return d},init:y,keyboardAction:function(e,t,n){if("up"==t)d.previousRecord();else if("down"==t)d.nextRecord();else if("enter"==t){e.Modules.agingtypeHeaderEdit.Section.show({},()=>{b(e,d.CurrentRow)})}else if("typing"==t){n.preventDefault(),n.stopPropagation();const e=document.getElementById("agingtypeHeaderList-txt_searchtext"),t=n.key;e.focus(),"Backspace"==t?Module.deleteAtCursor(e,"backspace"):"Delete"==t?Module.deleteAtCursor(e,"delete"):Module.insertAtCursor(e,n.key)}},loadData:p,removeCurrentRow:function(e){const t=s.SelectedRow;d.removeRow(t)},selectNextRow:function(e){const t=s.SelectedRow;t.nextElementSibling&&(d.CurrentRow=t.nextElementSibling,b(e,t.nextElementSibling))},selectPreviousRow:function(e){const t=s.SelectedRow;t.previousElementSibling&&(d.CurrentRow=t.previousElementSibling,b(e,t.previousElementSibling))},setPagingButton:m,updateCurrentRow:function(e,t){const n=s.SelectedRow;try{d.updateRow(n,t)}catch(e){throw e}}});const L={},M=n.Crsl,S=n.Sections.agingtypeHeaderEdit,k=M.Items[S],C=n.Source,I="New Aging Type",H="View Aging Type",_="Edit Aging Type",B="Edit",A="Lock",x=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_edit"),R=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_save"),$=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_new","agingtypeHeader-new"),N=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_delete"),T=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_reset"),D=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_prev"),K=new $fgta5.ActionButton("agingtypeHeaderEdit-btn_next"),O=document.getElementById("agingtypeHeader-btn_recordstatus"),F=document.getElementById("agingtypeHeader-btn_logs"),P=document.getElementById("agingtypeHeader-btn_about"),U=new $fgta5.Form("agingtypeHeaderEdit-frm");U.Inputs["agingtypeHeaderEdit-obj_agingtype_id"],U.Inputs["agingtypeHeaderEdit-obj_agingtype_name"],U.Inputs["agingtypeHeaderEdit-obj_agingtype_Descr"];const j=document.getElementById("fRecord-section-createby"),V=document.getElementById("fRecord-section-createdate"),q=document.getElementById("fRecord-section-modifyby"),G=document.getElementById("fRecord-section-modifydate"),z=k;async function W(t,a){k.addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{Q()}),U.addEventListener("locked",e=>{!async function(e){k.Title=H,x.setText(B),x.disabled=!1,R.disabled=!0,$.disabled=!1,N.disabled=!0,T.disabled=!0,D.disabled=!1,K.disabled=!1;const t=o.agingtypeHeaderEdit_formLocked;"function"==typeof t&&t(e,U,L);L.editDisabled&&(x.disabled=!0)}(t)}),U.addEventListener("unlocked",e=>{!async function(e){U.isNew()?k.Title=I:k.Title=_;x.setText(A),x.disabled=!1,R.disabled=!1,$.disabled=!0,N.disabled=!1,T.disabled=!1,D.disabled=!0,K.disabled=!0;const t=o.agingtypeHeaderEdit_formUnlocked;"function"==typeof t&&t(e,U)}(t)}),U.render(),x.addEventListener("click",e=>{!async function(){if(U.isLocked())U.lock(!1);else{if(U.isChanged()||U.isNew())return void await $fgta5.MessageBox.warning(Module.EDIT_WARNING);U.lock(!0)}}()}),R.addEventListener("click",e=>{!async function(e){const t=o.agingtypeHeaderEdit_autofill;"function"==typeof t&&await t(e,U);if(!U.validate()){const e=U.getLastError();return void $fgta5.MessageBox.warning(e)}let a;const i=U.isNew();if(i)a=U.getData();else{if(!U.isChanged())return;a=U.getDataChanged()}const c=o.agingtypeHeaderEdit_dataSaving;"function"==typeof c&&await c(e,a,U);let r=null;const s=U.getFiles();if(null!=s){r=new FormData;for(let e in s){const t=s[e];r.append(e,t)}}let d=$fgta5.Modal.createMask();try{let t;t=i?await async function(e,t,a){const o=`/${n.moduleName}/header-create`;try{return await Module.apiCall(o,{data:t,source:C},a)}catch(e){throw e}}(0,a,r):await async function(e,t,a){const o=`/${n.moduleName}/header-update`;try{return await Module.apiCall(o,{data:t,source:C},a)}catch(e){throw e}}(0,a,r);const c=U.getPrimaryInput(),s=t[c.getBindingData()],d=await J(e,s);L.currentOpenedId=s,U.AutoID?c.value=s:X(e,{disabled:!0}),U.setData(d);const l=o["agingtypeHeaderEdit_dataSaved"];"function"==typeof l&&await l(e,d,U),U.acceptChanges(),i?(x.disabled=!1,e.Modules.agingtypeHeaderList.addNewRow(e,d)):e.Modules.agingtypeHeaderList.updateCurrentRow(e,d)}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{d.close(),d=null}}(t)}),$.addEventListener("click",e=>{!async function(e,t){const n=t.target.getAttribute("data-sectionsource"),a=e.Modules.agingtypeHeaderList,i=a.Section.Id,c=n===i;if(c)await k.show();else{let e=!1;if(U.isChanged()){"cancel"==await $fgta5.MessageBox.confirm(Module.NEWDATA_CONFIRM)&&(e=!0)}if(e)return}U.AutoID?X(e,{disabled:!0,placeholder:"[AutoID]"}):X(e,{disabled:!1,placeholder:"ID"});try{let t={};const n=o["agingtypeHeaderEdit_newData"];"function"==typeof n&&await n(e,t,U),await Z(e,t),U.lock(!1),x.disabled=!0,N.disabled=!0}catch(t){console.error(t),await $fgta5.MessageBox.error(t.message),c&&e.Modules.agingtypeHeaderList.Section.show()}}(t,e)}),N.addEventListener("click",e=>{!async function(e){if(U.isNew())return;const t=U.getPrimaryInput().value;if("ok"!=await $fgta5.MessageBox.confirm(Module.DELETE_CONFIRM+`id: ${t}`))return;let a=$fgta5.Modal.createMask();try{await async function(e,t){const a=`/${n.moduleName}/header-delete`;try{return await Module.apiCall(a,{id:t,source:C})}catch(e){throw e}}(0,t);e.Modules.agingtypeHeaderList.removeCurrentRow(e),e.Modules.agingtypeHeaderList.Section.show(),U.lock()}catch(e){console.error(e),await $fgta5.MessageBox.error(e.message)}finally{a.close(),a=null}}(t)}),T.addEventListener("click",e=>{!async function(){if(U.isNew())Z();else if(U.isChanged()){if("ok"!=await $fgta5.MessageBox.confirm(Module.RESET_CONFIRM))return;U.reset()}}()}),D.addEventListener("click",e=>{!async function(e){e.Modules.agingtypeHeaderList.selectPreviousRow(e)}(t)}),K.addEventListener("click",e=>{!async function(e){e.Modules.agingtypeHeaderList.selectNextRow(e)}(t)}),O.addEventListener("click",a=>{!async function(t){const a={Context:n,sectionReturn:k};e.openSection(t,"fRecord-section",a,async()=>{let e=$fgta5.Modal.createMask();try{const e=U.getPrimaryInput().value,n=await J(t,e);j.innerHTML=n._createby,V.innerHTML=n._createdate,q.innerHTML=n._modifyby,G.innerHTML=n._modifydate;const a=o["agingtypeHeaderEdit_addRecordInfo"];"function"==typeof a&&await a(t,n)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{e.close(),e=null}})}(t)}),F.addEventListener("click",a=>{!async function(t){const a={Context:n,sectionReturn:k};e.openSection(t,"fLogs-section",a,async()=>{const t=U.getPrimaryInput().value;let a=$fgta5.Modal.createMask();try{const a=`${n.appsUrls.core.url}/logs/list`,o={module:n.moduleName,table:"act.agingtype",id:t},i=await Module.apiCall(a,{criteria:o}),c=document.getElementById("fLogs-section").querySelector("tbody");e.renderLog(c,i.data)}catch(e){console.error(e),$fgta5.MessageBox.error(e.message)}finally{a.close(),a=null}})}(t)}),P.addEventListener("click",a=>{!async function(t){const a={Context:n,sectionReturn:k};e.openSection(t,"fAbout-section",a,async()=>{M.Items["fAbout-section"].Title="About Aging Type";const e=document.getElementById("fAbout-section");if(null==document.getElementById("fAbout-section-fdescr")){const t=document.createElement("div");t.setAttribute("id","fAbout-section-fdescr"),t.setAttribute("style","padding: 0 0 10px 0"),t.innerHTML="Definisi Tipe Aging";const n=e.querySelector("div[data-topbar]");n.parentNode.insertBefore(t,n.nextSibling)}if(null==document.getElementById("fAbout-section-footer")){const t=document.createElement("div");t.setAttribute("id","fAbout-section-footer"),t.setAttribute("style","border-top: 1px solid #ccc; padding: 5px 0 0 0; margin-top: 50px"),t.innerHTML="This module is generated by fgta5 generator at 10 Oct 2025 18:07",e.appendChild(t)}})}(t)})}async function Z(e,t){try{U.newData(t),U.acceptChanges(),U.setAsNewData()}catch(e){throw e}}async function J(e,t){const a=`/${n.moduleName}/header-open`;try{return await Module.apiCall(a,{id:t})}catch(e){throw e}}async function Q(e,t){let a=!1;U.isChanged()?"ok"==await $fgta5.MessageBox.confirm(Module.BACK_CONFIRM)&&(U.reset(),a=!0):a=!0;if(a){U.lock();const e=n.Sections.agingtypeHeaderList;M.Items[e].show({direction:1})}}async function X(e,t){const n=U.getPrimaryInput();n.disabled=!0===t.disabled,void 0!==t.placeholder&&(n.placeholder=t.placeholder),void 0!==t.value&&(n.value=t.value)}var Y=Object.freeze({__proto__:null,Section:z,clearForm:function(e,t){U.clear(t)},disableNextButton:function(e,t=!0){K.disabled=t},disablePrevButton:function(e,t=!0){D.disabled=t},getForm:function(e){return U},getHeaderForm:function(e){return U},init:W,keyboardAction:function(e,t){"save"==t?(U.acceptInput(),R.click()):"new"==t?(U.acceptInput(),$.click()):"escape"==t?(U.acceptInput(),U.isLocked()||U.isNew()?Q():x.click()):"togleEdit"==t?(U.acceptInput(),x.click()):"right"==t?K.click():"left"==t&&D.click()},openSelectedData:async function(e,t){let n=$fgta5.Modal.createMask();try{const n=t.keyvalue,a=await J(e,n);L.currentOpenedId=n;const i=o["agingtypeHeaderEdit_isEditDisabled"];if("function"==typeof i){const t=i(e,a);L.editDisabled=t}X(e,{disabled:!0}),U.setData(a),U.acceptChanges(),U.lock();const c=o["agingtypeHeaderEdit_formOpened"];"function"==typeof c&&c(e,U,L)}catch(e){throw L.currentOpenedId=null,e}finally{n.close(),n=null}}});const ee=n.app,te=n.Crsl;class ne extends Module{constructor(){super()}async main(e={}){ee.setTitle("Aging Type"),ee.showFooter(!0),e.autoLoadGridData=!0;const t=this;t.Modules={agingtypeHeaderList:h,agingtypeHeaderEdit:Y};try{try{const e=await Module.apiCall(`/${n.moduleName}/init`,{});n.notifierId=e.notifierId,n.notifierSocket=e.notifierSocket,n.userId=e.userId,n.userFullname=e.userFullname,n.sid=e.sid,n.appsUrls=e.appsUrls}catch(e){throw e}await Promise.all([y(t,e),W(t),a()]),await async function(e){try{const t=document.getElementsByClassName("footer-buttons-container");Module.renderFooterButtons(t),te.setIconUrl(""),te.addEventListener($fgta5.SectionCarousell.EVT_SECTIONSHOWING,e=>{var n=e.detail.commingSection.Id;for(let e of t){e.getAttribute("data-section")==n?setTimeout(()=>{e.classList.remove("hidden"),e.style.animation="dropped 0.3s forwards",setTimeout(()=>{e.style.animation="unset"},300)},500):e.classList.add("hidden")}}),te.Items["fRecord-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()}),te.Items["fLogs-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()}),te.Items["fAbout-section"].addEventListener($fgta5.Section.EVT_BACKBUTTONCLICK,async e=>{e.detail.fn_ShowNextSection()});document.getElementById("panel-detil-selector").querySelectorAll(".panel-detil-row a").forEach(t=>{t.addEventListener("mouseenter",()=>{t.closest(".panel-detil-row").classList.add("panel-detil-row-highligted")}),t.addEventListener("mouseleave",()=>{t.closest(".panel-detil-row").classList.remove("panel-detil-row-highligted")});const a=t.getAttribute("data-target-section"),o=t.getAttribute("data-current-section");t.addEventListener("click",t=>{!function(e,t,a){const o=n.Sections[a],i=te.Items[o],c=n.Sections[t],r=te.Items[c];r.setSectionReturn(i),r.show({},()=>{const n=e.Modules[t],o=e.Modules[a];n.openList(e,{moduleHeaderEdit:o})})}(e,a,o)})});const a=o["extendPage"];"function"==typeof a&&a(e)}catch(e){throw e}}(t),function(e){const t=/^[a-zA-Z0-9 ]$/;document.addEventListener("keydown",a=>{if(a.ctrlKey||a.metaKey||a.altKey);else if(t.test(a.key)||"Backspace"===a.key||"Delete"===a.key){const t=te.CurrentSection.Id,o=n.SectionMap[t],i=e.Modules[o];ae(e,i,"typing",a)}},!0),document.addEventListener("keydown",t=>{const a=te.CurrentSection.Id,o=n.SectionMap[a],i=e.Modules[o],c=document.querySelector("dialog[open]");if(c)return void("escape"==t.key.toLowerCase()?(c.close(),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"s"===t.key.toLowerCase()&&t.preventDefault());const r=t.key.toLowerCase();(t.ctrlKey||t.metaKey)&&"s"===r?(t.preventDefault(),ae(e,i,"save",t)):(t.ctrlKey||t.metaKey)&&"n"===r||t.ctrlKey&&"f2"===r?(t.preventDefault(),ae(e,i,"new",t)):"escape"===r?(t.preventDefault(),ae(e,i,"escape",t)):"f2"===r?ae(e,i,"togleEdit",t):"arrowup"===r?ae(e,i,"up",t):"arrowdown"===r?ae(e,i,"down",t):"arrowright"===r?ae(e,i,"right",t):"arrowleft"===r?ae(e,i,"left",t):"enter"===r&&ae(e,i,"enter",t)})}(t);const i=["agingtypeHeaderEdit"];window.onbeforeunload=e=>{let n=!1;for(var a of i){t.Modules[a].getForm(t).isChanged()&&(n=n||!0)}if(n)return e.preventDefault(),"Changes you made may not be saved."}}catch(e){throw e}}}function ae(e,t,n,a){null!=t?t.keyboardAction(e,n,a):"escape"==n&&te.CurrentSection.back()}export{ne as default};
